Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 6
Rules claiming more threads will be scaled down.
Job stats:
job              count    min threads    max threads
-------------  -------  -------------  -------------
align                1              1              1
all                  1              1              1
ancestral            1              1              1
cleavage_site        1              1              1
export               1              1              1
filter               1              1              1
parse                1              1              1
refine               1              1              1
traits               1              1              1
translate            1              1              1
tree                 1              1              1
total               11              1              1

Select jobs to execute...

[Wed Apr 26 17:53:07 2023]
Job 6: Parsing fasta into sequences and metadata
Reason: Updated input files: h3nx_seg_filtered/h3nx_ha.fa


        augur parse             --sequences h3nx_seg_filtered/h3nx_ha.fa             --output-sequences results/sequences_h3nx_ha.fasta             --output-metadata results/metadata_h3nx_ha.tsv             --fields strain accession subtype date host country             --prettify-fields country host
        
[Wed Apr 26 17:53:10 2023]
Finished job 6.
1 of 11 steps (9%) done
Select jobs to execute...

[Wed Apr 26 17:53:10 2023]
Job 5: 
        Filtering to
          - 50 sequence(s) per year country host subtype
          - excluding strains in config/dropped_strains_h3nx.txt
          - samples with missing region and country metadata
          - excluding strains prior to 1997
        
Reason: Input files updated by another job: results/metadata_h3nx_ha.tsv, results/sequences_h3nx_ha.fasta


        augur filter             --sequences results/sequences_h3nx_ha.fasta             --metadata results/metadata_h3nx_ha.tsv             --exclude config/dropped_strains_h3nx.txt             --include config/include_strains_h3nx.txt             --output results/filtered_h3nx_ha.fasta             --group-by year country host subtype             --sequences-per-group 50             --min-date 1997             --exclude-where host=laboratoryderived host=ferret host=unknown host=other country=? region=?             --min-length 1600             --non-nucleotide
        
[Wed Apr 26 17:53:12 2023]
Finished job 5.
2 of 11 steps (18%) done
Select jobs to execute...

[Wed Apr 26 17:53:12 2023]
Job 4: 
        Aligning sequences to config/references/h3nx_ha.gb
          - filling gaps with N
        
Reason: Input files updated by another job: results/filtered_h3nx_ha.fasta


        augur align             --sequences results/filtered_h3nx_ha.fasta             --reference-sequence config/references/h3nx_ha.gb             --output results/aligned_h3nx_ha.fasta             --remove-reference             --nthreads 1
        
[Wed Apr 26 18:12:43 2023]
Finished job 4.
3 of 11 steps (27%) done
Select jobs to execute...

[Wed Apr 26 18:12:43 2023]
Job 10: determining sequences that harbor furin cleavage sites
Reason: Input files updated by another job: results/aligned_h3nx_ha.fasta


        python scripts/annotate-ha-cleavage-site.py             --alignment results/aligned_h3nx_ha.fasta             --furin_site_motif results/cleavage-site_h3nx_ha.json             --cleavage_site_sequence results/cleavage-site-sequences_h3nx_ha.json
        

[Wed Apr 26 18:12:43 2023]
Job 3: Building tree
Reason: Input files updated by another job: results/aligned_h3nx_ha.fasta


        augur tree             --alignment results/aligned_h3nx_ha.fasta             --output results/tree-raw_h3nx_ha.nwk             --method iqtree             --nthreads 1
        
[Wed Apr 26 18:12:44 2023]
Finished job 10.
4 of 11 steps (36%) done
[Wed Apr 26 18:40:52 2023]
Finished job 3.
5 of 11 steps (45%) done
Select jobs to execute...

[Wed Apr 26 18:40:52 2023]
Job 2: 
        Refining tree
          - estimate timetree
          - use const coalescent timescale
          - estimate marginal node dates
        
Reason: Input files updated by another job: results/tree-raw_h3nx_ha.nwk, results/aligned_h3nx_ha.fasta, results/metadata_h3nx_ha.tsv


        augur refine             --tree results/tree-raw_h3nx_ha.nwk             --alignment results/aligned_h3nx_ha.fasta             --metadata results/metadata_h3nx_ha.tsv             --output-tree results/tree_h3nx_ha.nwk             --output-node-data results/branch-lengths_h3nx_ha.json             --timetree             --coalescent const             --date-confidence             --date-inference marginal             --clock-filter-iqd 4
        
[Wed Apr 26 18:50:57 2023]
Finished job 2.
6 of 11 steps (55%) done
Select jobs to execute...

[Wed Apr 26 18:50:57 2023]
Job 7: Inferring ancestral traits for host country
Reason: Input files updated by another job: results/metadata_h3nx_ha.tsv, results/tree_h3nx_ha.nwk


        augur traits             --tree results/tree_h3nx_ha.nwk             --metadata results/metadata_h3nx_ha.tsv             --output results/traits_h3nx_ha.json             --columns host country             --confidence
        

[Wed Apr 26 18:50:57 2023]
Job 8: Reconstructing ancestral sequences and mutations
Reason: Input files updated by another job: results/aligned_h3nx_ha.fasta, results/tree_h3nx_ha.nwk


        augur ancestral             --tree results/tree_h3nx_ha.nwk             --alignment results/aligned_h3nx_ha.fasta             --output-node-data results/nt-muts_h3nx_ha.json             --inference joint            --keep-ambiguous
        
[Wed Apr 26 18:51:12 2023]
Finished job 8.
7 of 11 steps (64%) done
Select jobs to execute...

[Wed Apr 26 18:51:12 2023]
Job 9: Translating amino acid sequences
Reason: Input files updated by another job: results/nt-muts_h3nx_ha.json, results/tree_h3nx_ha.nwk


        augur translate             --tree results/tree_h3nx_ha.nwk             --ancestral-sequences results/nt-muts_h3nx_ha.json             --reference-sequence config/references/h3nx_ha.gb             --output results/aa-muts_h3nx_ha.json
        
[Wed Apr 26 18:51:15 2023]
Finished job 9.
8 of 11 steps (73%) done
[Wed Apr 26 18:51:53 2023]
Finished job 7.
9 of 11 steps (82%) done
Select jobs to execute...

[Wed Apr 26 18:51:53 2023]
Job 1: Exporting data files for for auspice
Reason: Input files updated by another job: results/cleavage-site_h3nx_ha.json, results/branch-lengths_h3nx_ha.json, results/tree_h3nx_ha.nwk, results/traits_h3nx_ha.json, results/cleavage-site-sequences_h3nx_ha.json, results/aa-muts_h3nx_ha.json, results/metadata_h3nx_ha.tsv, results/nt-muts_h3nx_ha.json


        augur export v2             --tree results/tree_h3nx_ha.nwk             --metadata results/metadata_h3nx_ha.tsv             --node-data results/branch-lengths_h3nx_ha.json results/traits_h3nx_ha.json results/nt-muts_h3nx_ha.json results/aa-muts_h3nx_ha.json results/cleavage-site_h3nx_ha.json results/cleavage-site-sequences_h3nx_ha.json            --auspice-config config/auspice_config_h3nx.json             --include-root-sequence             --output auspice/nonhuman_influenza_h3nx_ha.json
        
[Wed Apr 26 18:52:05 2023]
Finished job 1.
10 of 11 steps (91%) done
Select jobs to execute...

[Wed Apr 26 18:52:05 2023]
localrule all:
    input: auspice/nonhuman_influenza_h3nx_ha.json, auspice/nonhuman_influenza_h3nx_pb2.json, auspice/nonhuman_influenza_h3nx_pb1.json, auspice/nonhuman_influenza_h3nx_na.json, auspice/nonhuman_influenza_h3nx_np.json, auspice/nonhuman_influenza_h3nx_pa.json, auspice/nonhuman_influenza_h3nx_ns.json, auspice/nonhuman_influenza_h3nx_mp.json
    jobid: 0
    reason: Input files updated by another job: auspice/nonhuman_influenza_h3nx_ha.json
    resources: tmpdir=/tmp

[Wed Apr 26 18:52:05 2023]
Finished job 0.
11 of 11 steps (100%) done
Complete log: .snakemake/log/2023-04-26T175307.251994.snakemake.log
